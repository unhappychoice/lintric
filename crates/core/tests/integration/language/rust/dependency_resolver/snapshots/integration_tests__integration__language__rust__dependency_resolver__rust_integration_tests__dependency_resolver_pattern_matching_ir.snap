---
source: crates/core/tests/integration/language/rust/dependency_resolver/rust_integration_tests.rs
expression: ir_snapshot_content
---
Source Code:
enum Message {
    Text(String),
    Number(i32),
    Quit,
}

struct Handler {
    name: String,
}

impl Handler {
    fn new(name: String) -> Self {
        Handler { name }
    }
    
    fn handle(&self, msg: Message) {
        match msg {
            Message::Text(text) => {
                println!("{}: {}", self.name, text);
            }
            Message::Number(num) => {
                println!("{}: Number {}", self.name, num);
            }
            Message::Quit => {
                println!("{}: Quitting", self.name);
            }
        }
    }
}

fn main() {
    let handler = Handler::new("Main".to_string());
    
    handler.handle(Message::Text("Hello".to_string()));
    handler.handle(Message::Number(42));
    handler.handle(Message::Quit);
}

AST:
(source_file
  (enum_item
    name: (type_identifier "Message")
    body: (enum_variant_list
      (enum_variant
        name: (identifier "Text")
        body: (ordered_field_declaration_list
          type: (type_identifier "String")
        )
      )
      (enum_variant
        name: (identifier "Number")
        body: (ordered_field_declaration_list
          type: (primitive_type "i32")
        )
      )
      (enum_variant
        name: (identifier "Quit")
      )
    )
  )
  (struct_item
    name: (type_identifier "Handler")
    body: (field_declaration_list
      (field_declaration
        name: (field_identifier "name")
        type: (type_identifier "String")
      )
    )
  )
  (impl_item
    type: (type_identifier "Handler")
    body: (declaration_list
      (function_item
        name: (identifier "new")
        parameters: (parameters
          (parameter
            pattern: (identifier "name")
            type: (type_identifier "String")
          )
        )
        return_type: (type_identifier "Self")
        body: (block
          (struct_expression
            name: (type_identifier "Handler")
            body: (field_initializer_list
              (shorthand_field_initializer
                (identifier "name")
              )
            )
          )
        )
      )
      (function_item
        name: (identifier "handle")
        parameters: (parameters
          (self_parameter
            (self "self")
          )
          (parameter
            pattern: (identifier "msg")
            type: (type_identifier "Message")
          )
        )
        body: (block
          (expression_statement
            (match_expression
              value: (identifier "msg")
              body: (match_block
                (match_arm
                  pattern: (match_pattern
                    (tuple_struct_pattern
                      type: (scoped_identifier "Message::Text"
                        path: (identifier "Message")
                        name: (identifier "Text")
                      )
                      (identifier "text")
                    )
                  )
                  value: (block
                    (expression_statement
                      (macro_invocation
                        macro: (identifier "println")
                        (token_tree
                          (string_literal ""{}: {}""
                            (string_content)
                          )
                          (self "self")
                          (identifier "name")
                          (identifier "text")
                        )
                      )
                    )
                  )
                )
                (match_arm
                  pattern: (match_pattern
                    (tuple_struct_pattern
                      type: (scoped_identifier "Message::Number"
                        path: (identifier "Message")
                        name: (identifier "Number")
                      )
                      (identifier "num")
                    )
                  )
                  value: (block
                    (expression_statement
                      (macro_invocation
                        macro: (identifier "println")
                        (token_tree
                          (string_literal ""{}: Number {}""
                            (string_content)
                          )
                          (self "self")
                          (identifier "name")
                          (identifier "num")
                        )
                      )
                    )
                  )
                )
                (match_arm
                  pattern: (match_pattern
                    (scoped_identifier "Message::Quit"
                      path: (identifier "Message")
                      name: (identifier "Quit")
                    )
                  )
                  value: (block
                    (expression_statement
                      (macro_invocation
                        macro: (identifier "println")
                        (token_tree
                          (string_literal ""{}: Quitting""
                            (string_content)
                          )
                          (self "self")
                          (identifier "name")
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
    )
  )
  (function_item
    name: (identifier "main")
    parameters: (parameters)
    body: (block
      (let_declaration
        pattern: (identifier "handler")
        value: (call_expression
          function: (scoped_identifier "Handler::new"
            path: (identifier "Handler")
            name: (identifier "new")
          )
          arguments: (arguments
            (call_expression
              function: (field_expression
                value: (string_literal ""Main""
                  (string_content)
                )
                field: (field_identifier "to_string")
              )
              arguments: (arguments)
            )
          )
        )
      )
      (expression_statement
        (call_expression
          function: (field_expression
            value: (identifier "handler")
            field: (field_identifier "handle")
          )
          arguments: (arguments
            (call_expression
              function: (scoped_identifier "Message::Text"
                path: (identifier "Message")
                name: (identifier "Text")
              )
              arguments: (arguments
                (call_expression
                  function: (field_expression
                    value: (string_literal ""Hello""
                      (string_content)
                    )
                    field: (field_identifier "to_string")
                  )
                  arguments: (arguments)
                )
              )
            )
          )
        )
      )
      (expression_statement
        (call_expression
          function: (field_expression
            value: (identifier "handler")
            field: (field_identifier "handle")
          )
          arguments: (arguments
            (call_expression
              function: (scoped_identifier "Message::Number"
                path: (identifier "Message")
                name: (identifier "Number")
              )
              arguments: (arguments
                (integer_literal "42")
              )
            )
          )
        )
      )
      (expression_statement
        (call_expression
          function: (field_expression
            value: (identifier "handler")
            field: (field_identifier "handle")
          )
          arguments: (arguments
            (scoped_identifier "Message::Quit"
              path: (identifier "Message")
              name: (identifier "Quit")
            )
          )
        )
      )
    )
  )
)

IR:
IntermediateRepresentation {
    file_path: "tests/integration/language/rust/dependency_resolver/fixtures/pattern_matching.rs",
    definitions: [
        Definition { position: { 1:6 to 1:13 }, name: "Message", definition_type: EnumDefinition, scope_id: Some(0), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 7:8 to 7:15 }, name: "Handler", definition_type: StructDefinition, scope_id: Some(0), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 8:5 to 8:9 }, name: "name", definition_type: StructFieldDefinition, scope_id: Some(0), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 12:8 to 12:11 }, name: "new", definition_type: MethodDefinition, scope_id: Some(1), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 12:12 to 12:16 }, name: "name", definition_type: VariableDefinition, scope_id: Some(1), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 16:8 to 16:14 }, name: "handle", definition_type: MethodDefinition, scope_id: Some(1), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 16:22 to 16:25 }, name: "msg", definition_type: VariableDefinition, scope_id: Some(1), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 18:27 to 18:31 }, name: "text", definition_type: VariableDefinition, scope_id: Some(6), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 21:29 to 21:32 }, name: "num", definition_type: VariableDefinition, scope_id: Some(6), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 31:4 to 31:8 }, name: "main", definition_type: FunctionDefinition, scope_id: Some(10), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
        Definition { position: { 32:9 to 32:16 }, name: "handler", definition_type: VariableDefinition, scope_id: Some(11), accessibility: Some(ScopeLocal), is_hoisted: Some(false) },
    ],
    dependencies: [
        Dependency { source_line: 11, target_line: 7, symbol: "Handler", dependency_type: TypeReference, context: Some("TypeIdentifier:11:6") },
        Dependency { source_line: 13, target_line: 7, symbol: "Handler", dependency_type: TypeReference, context: Some("TypeIdentifier:13:9") },
        Dependency { source_line: 13, target_line: 12, symbol: "name", dependency_type: VariableUse, context: Some("Identifier:13:19") },
        Dependency { source_line: 16, target_line: 1, symbol: "Message", dependency_type: TypeReference, context: Some("TypeIdentifier:16:27") },
        Dependency { source_line: 17, target_line: 16, symbol: "msg", dependency_type: VariableUse, context: Some("Identifier:17:15") },
        Dependency { source_line: 18, target_line: 1, symbol: "Message", dependency_type: VariableUse, context: Some("Identifier:18:13") },
        Dependency { source_line: 19, target_line: 8, symbol: "name", dependency_type: StructFieldAccess, context: Some("FieldExpression:19:41") },
        Dependency { source_line: 19, target_line: 18, symbol: "text", dependency_type: VariableUse, context: Some("Identifier:19:47") },
        Dependency { source_line: 21, target_line: 1, symbol: "Message", dependency_type: VariableUse, context: Some("Identifier:21:13") },
        Dependency { source_line: 22, target_line: 8, symbol: "name", dependency_type: StructFieldAccess, context: Some("FieldExpression:22:48") },
        Dependency { source_line: 22, target_line: 21, symbol: "num", dependency_type: VariableUse, context: Some("Identifier:22:54") },
        Dependency { source_line: 24, target_line: 1, symbol: "Message", dependency_type: VariableUse, context: Some("Identifier:24:13") },
        Dependency { source_line: 25, target_line: 8, symbol: "name", dependency_type: StructFieldAccess, context: Some("FieldExpression:25:47") },
        Dependency { source_line: 32, target_line: 7, symbol: "Handler", dependency_type: VariableUse, context: Some("Identifier:32:19") },
        Dependency { source_line: 32, target_line: 12, symbol: "new", dependency_type: VariableUse, context: Some("Identifier:32:28") },
        Dependency { source_line: 34, target_line: 16, symbol: "handle", dependency_type: StructFieldAccess, context: Some("FieldExpression:34:5") },
        Dependency { source_line: 34, target_line: 32, symbol: "handler", dependency_type: VariableUse, context: Some("Identifier:34:5") },
        Dependency { source_line: 34, target_line: 1, symbol: "Message", dependency_type: VariableUse, context: Some("Identifier:34:20") },
        Dependency { source_line: 35, target_line: 16, symbol: "handle", dependency_type: StructFieldAccess, context: Some("FieldExpression:35:5") },
        Dependency { source_line: 35, target_line: 32, symbol: "handler", dependency_type: VariableUse, context: Some("Identifier:35:5") },
        Dependency { source_line: 35, target_line: 1, symbol: "Message", dependency_type: VariableUse, context: Some("Identifier:35:20") },
        Dependency { source_line: 36, target_line: 16, symbol: "handle", dependency_type: StructFieldAccess, context: Some("FieldExpression:36:5") },
        Dependency { source_line: 36, target_line: 32, symbol: "handler", dependency_type: VariableUse, context: Some("Identifier:36:5") },
        Dependency { source_line: 36, target_line: 1, symbol: "Message", dependency_type: VariableUse, context: Some("Identifier:36:20") },
    ],
    usage: [
        Usage { position: { 2:5 to 2:9 }, name: "Text", kind: Identifier, context: None },
        Usage { position: { 2:10 to 2:16 }, name: "String", kind: TypeIdentifier, context: None },
        Usage { position: { 3:5 to 3:11 }, name: "Number", kind: Identifier, context: None },
        Usage { position: { 4:5 to 4:9 }, name: "Quit", kind: Identifier, context: None },
        Usage { position: { 8:11 to 8:17 }, name: "String", kind: TypeIdentifier, context: None },
        Usage { position: { 11:6 to 11:13 }, name: "Handler", kind: TypeIdentifier, context: None },
        Usage { position: { 12:18 to 12:24 }, name: "String", kind: TypeIdentifier, context: None },
        Usage { position: { 12:29 to 12:33 }, name: "Self", kind: TypeIdentifier, context: None },
        Usage { position: { 13:9 to 13:25 }, name: "Handler { name }", kind: StructExpression, context: None },
        Usage { position: { 13:9 to 13:16 }, name: "Handler", kind: TypeIdentifier, context: None },
        Usage { position: { 13:19 to 13:23 }, name: "name", kind: Identifier, context: None },
        Usage { position: { 16:27 to 16:34 }, name: "Message", kind: TypeIdentifier, context: None },
        Usage { position: { 17:15 to 17:18 }, name: "msg", kind: Identifier, context: None },
        Usage { position: { 18:13 to 18:20 }, name: "Message", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 18:22 to 18:26 }, name: "Text", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 18:27 to 18:31 }, name: "text", kind: Identifier, context: None },
        Usage { position: { 19:17 to 19:24 }, name: "println", kind: Identifier, context: None },
        Usage { position: { 19:41 to 19:45 }, name: "name", kind: FieldExpression, context: None },
        Usage { position: { 19:47 to 19:51 }, name: "text", kind: Identifier, context: None },
        Usage { position: { 21:13 to 21:20 }, name: "Message", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 21:22 to 21:28 }, name: "Number", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 21:29 to 21:32 }, name: "num", kind: Identifier, context: None },
        Usage { position: { 22:17 to 22:24 }, name: "println", kind: Identifier, context: None },
        Usage { position: { 22:48 to 22:52 }, name: "name", kind: FieldExpression, context: None },
        Usage { position: { 22:54 to 22:57 }, name: "num", kind: Identifier, context: None },
        Usage { position: { 24:13 to 24:20 }, name: "Message", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 24:22 to 24:26 }, name: "Quit", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 25:17 to 25:24 }, name: "println", kind: Identifier, context: None },
        Usage { position: { 25:47 to 25:51 }, name: "name", kind: FieldExpression, context: None },
        Usage { position: { 32:19 to 32:51 }, name: "Handler::new", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 32:19 to 32:26 }, name: "Handler", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 32:28 to 32:31 }, name: "new", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 32:32 to 32:50 }, name: "\"Main\".to_string", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 32:32 to 32:48 }, name: "to_string", kind: FieldExpression, context: Some("field_expression") },
        Usage { position: { 34:5 to 34:55 }, name: "handler.handle", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 34:5 to 34:19 }, name: "handle", kind: FieldExpression, context: Some("field_expression") },
        Usage { position: { 34:5 to 34:12 }, name: "handler", kind: Identifier, context: Some("field_expression") },
        Usage { position: { 34:20 to 34:54 }, name: "Message::Text", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 34:20 to 34:27 }, name: "Message", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 34:29 to 34:33 }, name: "Text", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 34:34 to 34:53 }, name: "\"Hello\".to_string", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 34:34 to 34:51 }, name: "to_string", kind: FieldExpression, context: Some("field_expression") },
        Usage { position: { 35:5 to 35:40 }, name: "handler.handle", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 35:5 to 35:19 }, name: "handle", kind: FieldExpression, context: Some("field_expression") },
        Usage { position: { 35:5 to 35:12 }, name: "handler", kind: Identifier, context: Some("field_expression") },
        Usage { position: { 35:20 to 35:39 }, name: "Message::Number", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 35:20 to 35:27 }, name: "Message", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 35:29 to 35:35 }, name: "Number", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 36:5 to 36:34 }, name: "handler.handle", kind: CallExpression, context: Some("call_expression") },
        Usage { position: { 36:5 to 36:19 }, name: "handle", kind: FieldExpression, context: Some("field_expression") },
        Usage { position: { 36:5 to 36:12 }, name: "handler", kind: Identifier, context: Some("field_expression") },
        Usage { position: { 36:20 to 36:27 }, name: "Message", kind: Identifier, context: Some("scoped_identifier") },
        Usage { position: { 36:29 to 36:33 }, name: "Quit", kind: Identifier, context: Some("scoped_identifier") },
    ],
    analysis_metadata: AnalysisMetadata {
        language: "Rust",
        total_lines: 37,
        analysis_timestamp: "now",
        lintric_version: "0.1.0",
    },
}
