---
source: crates/core/tests/integration/language/rust/dependency_resolver/rust_integration_tests.rs
expression: ir_snapshot_content
---
Source Code:
fn main() {
    let captured = 42;
    let mut mutable_capture = 10;
    
    let closure = || {
        println!("{}", captured);
        mutable_capture += 1;
        println!("{}", mutable_capture);
    };
    
    closure();
    
    let move_closure = move || {
        println!("Moved: {}", captured);
    };
    
    move_closure();
}

AST:
(source_file
  (function_item
    name: (identifier "main")
    parameters: (parameters)
    body: (block
      (let_declaration
        pattern: (identifier "captured")
        value: (integer_literal "42")
      )
      (let_declaration
        (mutable_specifier)
        pattern: (identifier "mutable_capture")
        value: (integer_literal "10")
      )
      (let_declaration
        pattern: (identifier "closure")
        value: (closure_expression
          parameters: (closure_parameters)
          body: (block
            (expression_statement
              (macro_invocation
                macro: (identifier "println")
                (token_tree
                  (string_literal ""{}""
                    (string_content)
                  )
                  (identifier "captured")
                )
              )
            )
            (expression_statement
              (compound_assignment_expr
                left: (identifier "mutable_capture")
                right: (integer_literal "1")
              )
            )
            (expression_statement
              (macro_invocation
                macro: (identifier "println")
                (token_tree
                  (string_literal ""{}""
                    (string_content)
                  )
                  (identifier "mutable_capture")
                )
              )
            )
          )
        )
      )
      (expression_statement
        (call_expression
          function: (identifier "closure")
          arguments: (arguments)
        )
      )
      (let_declaration
        pattern: (identifier "move_closure")
        value: (closure_expression
          parameters: (closure_parameters)
          body: (block
            (expression_statement
              (macro_invocation
                macro: (identifier "println")
                (token_tree
                  (string_literal ""Moved: {}""
                    (string_content)
                  )
                  (identifier "captured")
                )
              )
            )
          )
        )
      )
      (expression_statement
        (call_expression
          function: (identifier "move_closure")
          arguments: (arguments)
        )
      )
    )
  )
)

IR:
IntermediateRepresentation {
    file_path: "tests/integration/language/rust/dependency_resolver/fixtures/closure_dependencies.rs",
    definitions: [
        Definition {
            name: "main",
            position: Position {
                start_line: 1,
                start_column: 4,
                end_line: 1,
                end_column: 8,
            },
            definition_type: FunctionDefinition,
        },
        Definition {
            name: "captured",
            position: Position {
                start_line: 2,
                start_column: 9,
                end_line: 2,
                end_column: 17,
            },
            definition_type: VariableDefinition,
        },
        Definition {
            name: "mutable_capture",
            position: Position {
                start_line: 3,
                start_column: 13,
                end_line: 3,
                end_column: 28,
            },
            definition_type: VariableDefinition,
        },
        Definition {
            name: "closure",
            position: Position {
                start_line: 5,
                start_column: 9,
                end_line: 5,
                end_column: 16,
            },
            definition_type: VariableDefinition,
        },
        Definition {
            name: "move_closure",
            position: Position {
                start_line: 13,
                start_column: 9,
                end_line: 13,
                end_column: 21,
            },
            definition_type: VariableDefinition,
        },
    ],
    dependencies: [
        Dependency {
            source_line: 6,
            target_line: 2,
            symbol: "captured",
            dependency_type: VariableUse,
            context: Some(
                "Identifier:6:24",
            ),
        },
        Dependency {
            source_line: 7,
            target_line: 3,
            symbol: "mutable_capture",
            dependency_type: VariableUse,
            context: Some(
                "Identifier:7:9",
            ),
        },
        Dependency {
            source_line: 8,
            target_line: 3,
            symbol: "mutable_capture",
            dependency_type: VariableUse,
            context: Some(
                "Identifier:8:24",
            ),
        },
        Dependency {
            source_line: 11,
            target_line: 5,
            symbol: "closure",
            dependency_type: FunctionCall,
            context: Some(
                "CallExpression:11:5",
            ),
        },
        Dependency {
            source_line: 14,
            target_line: 2,
            symbol: "captured",
            dependency_type: VariableUse,
            context: Some(
                "Identifier:14:31",
            ),
        },
        Dependency {
            source_line: 17,
            target_line: 13,
            symbol: "move_closure",
            dependency_type: FunctionCall,
            context: Some(
                "CallExpression:17:5",
            ),
        },
    ],
    usage: [
        Usage {
            name: "println",
            kind: Identifier,
            position: Position {
                start_line: 6,
                start_column: 9,
                end_line: 6,
                end_column: 16,
            },
        },
        Usage {
            name: "captured",
            kind: Identifier,
            position: Position {
                start_line: 6,
                start_column: 24,
                end_line: 6,
                end_column: 32,
            },
        },
        Usage {
            name: "mutable_capture",
            kind: Identifier,
            position: Position {
                start_line: 7,
                start_column: 9,
                end_line: 7,
                end_column: 24,
            },
        },
        Usage {
            name: "println",
            kind: Identifier,
            position: Position {
                start_line: 8,
                start_column: 9,
                end_line: 8,
                end_column: 16,
            },
        },
        Usage {
            name: "mutable_capture",
            kind: Identifier,
            position: Position {
                start_line: 8,
                start_column: 24,
                end_line: 8,
                end_column: 39,
            },
        },
        Usage {
            name: "closure",
            kind: CallExpression,
            position: Position {
                start_line: 11,
                start_column: 5,
                end_line: 11,
                end_column: 14,
            },
        },
        Usage {
            name: "println",
            kind: Identifier,
            position: Position {
                start_line: 14,
                start_column: 9,
                end_line: 14,
                end_column: 16,
            },
        },
        Usage {
            name: "captured",
            kind: Identifier,
            position: Position {
                start_line: 14,
                start_column: 31,
                end_line: 14,
                end_column: 39,
            },
        },
        Usage {
            name: "move_closure",
            kind: CallExpression,
            position: Position {
                start_line: 17,
                start_column: 5,
                end_line: 17,
                end_column: 19,
            },
        },
    ],
    analysis_metadata: AnalysisMetadata {
        language: "Rust",
        total_lines: 18,
        analysis_timestamp: "now",
        lintric_version: "0.1.0",
    },
}
